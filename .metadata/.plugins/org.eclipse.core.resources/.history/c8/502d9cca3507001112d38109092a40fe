//package product_test_JPA;
//
//import static org.junit.jupiter.api.Assertions.assertNotNull;
//
//import javax.persistence.EntityManager;
//import javax.persistence.EntityManagerFactory;
//import javax.persistence.Persistence;
//
//import org.junit.jupiter.api.AfterAll;
//import org.junit.jupiter.api.AfterEach;
//import org.junit.jupiter.api.BeforeAll;
//import org.junit.jupiter.api.BeforeEach;
//import org.junit.jupiter.api.Test;
//
//import com.prac.Product;
//import com.prac.ProductDao;
//
//public class ProductTest {
//
//    static EntityManagerFactory emf;
//    EntityManager em;
//
//    @BeforeAll
//    public static void initEmf() {
//        emf = Persistence.createEntityManagerFactory("postgres");
//    }
//
//    @BeforeEach
//    public void initEm() {
//    	em=emf.createEntityManager();
//    }
//    
//    @Test
//    public void insert() {
//        ProductDao dao = new ProductDao();
//
//        Product product = new Product();
//        product.setId(2);
//        product.setName("Pencil");
//        product.setPrice(5);
//
//        dao.insertProduct(product);
//
//        Product saved = dao.findProduct(2);
//        assertNotNull(saved);
//        System.out.println("Product Inserted");
//    }
//
//    @Test
//    public void findById() {
//        ProductDao dao = new ProductDao();
//        Product p = dao.findProduct(2);
//        assertNotNull(p);
//        System.out.println("Product Found");
//    }
//    
//    @AfterEach
//    public void destEm() {
//    	em.close();
//    }
//    @AfterAll
//    public void dest() {
//    	emf.close();
//    }
//}


//package product_test_JPA;

//import static org.junit.jupiter.api.Assertions.assertNull;
//
//import org.junit.jupiter.api.BeforeEach;
//import org.junit.jupiter.api.Test;
//
//import com.prac.Product;
//import com.prac.ProductDao;
//
//public class ProductTest {
//
//    ProductDao dao;
//
//    @BeforeEach
//    public void setup() {
//        dao = new ProductDao();
//    }
//
//    // delete when product exists
//    @Test
//    public void deleteProduct_success() {
//
//        //insert a product first
//        Product product = new Product();
//        product.setId(100);
//        product.setName("Eraser");
//        product.setPrice(10);
//
//        dao.insertProduct(product);
//
//        //delete the product
//        dao.deleteProduct(100);
//
//        //product should not exist
//        Product deleted = dao.findProduct(100);
//        assertNull(deleted, "Product should be deleted");
//    }
//
//    // delete when product does NOT exist
//    @Test
//    public void deleteProduct_notFound() {
//
//        //delete non-existing product
//        dao.deleteProduct(999);
//
//        //no exception + product still null
//        Product p = dao.findProduct(999);
//        assertNull(p);
//    }
//}


package product_test_JPA;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertNull;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;

import org.junit.jupiter.api.AfterAll;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import com.prac.Product;
import com.prac.ProductDao;
//ctrl+shift+o

public class ProductTest {

	//emf
	//em
	//et
	static EntityManagerFactory emf;
	EntityManager em;
	
	@BeforeAll
	public static void initEmf() {
	emf=Persistence.createEntityManagerFactory("postgres");
	emf=Persistence.createEntityManagerFactory(null);
	}
	
	@BeforeEach
	public void initEm() {
		em=emf.createEntityManager();
	}

	@Test
	public void insertProductTest() {
		System.out.println("Product Insert");

		ProductDao dao = new ProductDao();
		Product product = new Product();
		product.setId(2);
		product.setName("Pencil");
		product.setPrice(5);
		String res=dao.insertProduct(product);
		assertEquals("Data Inserted",res);
	}
	
	@Test
	public void InsertNull() {
		ProductDao d= new ProductDao();
		String res=d.insertProduct(null);
		assertEquals("Illegal Argument",res);
		
	}
@Test
public void findByIdTest(int id) {
	System.out.println("Product Find");
	ProductDao dao=new ProductDao();
	Product p=dao.findProduct(100);
	assertNotNull(p);
}

@Test
public void deleteProductTest() {
    System.out.println("Product Delete Test");

    ProductDao dao = new ProductDao();

    Product product = new Product();
    product.setId(10);
    product.setName("Pen");
    product.setPrice(20);

    dao.insertProduct(product);

    dao.deleteProduct(10);

    Product p = dao.findProduct(10);
    assertNull(p);
}

@AfterEach
public void destroyEm() {
	em.close();
}
@AfterAll
public static void destryEmf() {
	emf.close();
}
}